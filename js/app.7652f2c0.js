(function(t){function e(e){for(var c,o,u=e[0],i=e[1],d=e[2],s=0,f=[];s<u.length;s++)o=u[s],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(t[c]=i[c]);m&&m(e);while(f.length)f.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],c=!0,o=1;o<n.length;o++){var u=n[o];0!==r[u]&&(c=!1)}c&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var c={},o={app:0},r={app:0},a=[];function u(t){return i.p+"js/"+({}[t]||t)+"."+{"chunk-16daef2d":"3bd08f10","chunk-201add18":"515c89cb","chunk-2faa4e68":"374e3ded","chunk-530ab66a":"3871812f","chunk-2d20fccc":"ea01871a","chunk-2d21dbd7":"16e71fcb","chunk-64534251":"86092bbb","chunk-720241ba":"d9cd69a8","chunk-76a56556":"fdf2ddb3","chunk-2d213365":"8d2bc7fe","chunk-bcdd3e26":"e9377cb2","chunk-7868cd31":"f3206985","chunk-7a1637f2":"b82691cb","chunk-8f62cc32":"264d4700","chunk-ec12f8ca":"7dc5eaa6"}[t]+".js"}function i(e){if(c[e])return c[e].exports;var n=c[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){var e=[],n={"chunk-16daef2d":1,"chunk-201add18":1,"chunk-2faa4e68":1,"chunk-530ab66a":1,"chunk-64534251":1,"chunk-720241ba":1,"chunk-7868cd31":1,"chunk-7a1637f2":1,"chunk-8f62cc32":1,"chunk-ec12f8ca":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise((function(e,n){for(var c="css/"+({}[t]||t)+"."+{"chunk-16daef2d":"60da3bbe","chunk-201add18":"8a8cb519","chunk-2faa4e68":"c67b02f4","chunk-530ab66a":"f28e5994","chunk-2d20fccc":"31d6cfe0","chunk-2d21dbd7":"31d6cfe0","chunk-64534251":"211981ce","chunk-720241ba":"05c62aa8","chunk-76a56556":"31d6cfe0","chunk-2d213365":"31d6cfe0","chunk-bcdd3e26":"31d6cfe0","chunk-7868cd31":"74e6cab0","chunk-7a1637f2":"3721bf6e","chunk-8f62cc32":"1d494088","chunk-ec12f8ca":"95ca4f4f"}[t]+".css",r=i.p+c,a=document.getElementsByTagName("link"),u=0;u<a.length;u++){var d=a[u],s=d.getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(s===c||s===r))return e()}var f=document.getElementsByTagName("style");for(u=0;u<f.length;u++){d=f[u],s=d.getAttribute("data-href");if(s===c||s===r)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var c=e&&e.target&&e.target.src||r,a=new Error("Loading CSS chunk "+t+" failed.\n("+c+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=c,delete o[t],m.parentNode.removeChild(m),n(a)},m.href=r;var h=document.getElementsByTagName("head")[0];h.appendChild(m)})).then((function(){o[t]=0})));var c=r[t];if(0!==c)if(c)e.push(c[2]);else{var a=new Promise((function(e,n){c=r[t]=[e,n]}));e.push(c[2]=a);var d,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=u(t);var f=new Error;d=function(e){s.onerror=s.onload=null,clearTimeout(m);var n=r[t];if(0!==n){if(n){var c=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+c+": "+o+")",f.name="ChunkLoadError",f.type=c,f.request=o,n[1](f)}r[t]=void 0}};var m=setTimeout((function(){d({type:"timeout",target:s})}),12e4);s.onerror=s.onload=d,document.head.appendChild(s)}return Promise.all(e)},i.m=t,i.c=c,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var c in t)i.d(n,c,function(e){return t[e]}.bind(null,c));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i.oe=function(t){throw console.error(t),t};var d=window["webpackJsonp"]=window["webpackJsonp"]||[],s=d.push.bind(d);d.push=e,d=d.slice();for(var f=0;f<d.length;f++)e(d[f]);var m=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("45fc"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),n("router-view")],1)},r=[],a={computed:{isLoading:function(){return this.$store.state.isLoading}}},u=a,i=(n("5c0b"),n("2877")),d=Object(i["a"])(u,o,r,!1,null,null,null),s=d.exports,f=(n("d3b7"),n("8c4f"));c["default"].use(f["a"]);var m=[{path:"/",component:function(){return n.e("chunk-8f62cc32").then(n.bind(null,"2bc2"))},children:[{path:"",name:"Home",component:function(){return Promise.all([n.e("chunk-201add18"),n.e("chunk-2faa4e68")]).then(n.bind(null,"ec5a"))}},{path:"/about",name:"About",component:function(){return n.e("chunk-7a1637f2").then(n.bind(null,"9cbb"))}},{path:"products",name:"Products",component:function(){return n.e("chunk-16daef2d").then(n.bind(null,"ed84"))}},{path:"products/:productId",name:"SingleProduct",component:function(){return Promise.all([n.e("chunk-201add18"),n.e("chunk-530ab66a")]).then(n.bind(null,"fef1"))}},{path:"signin",name:"Login",component:function(){return Promise.all([n.e("chunk-76a56556"),n.e("chunk-2d213365")]).then(n.bind(null,"ac5b"))}}]},{path:"/checkout",component:function(){return n.e("chunk-64534251").then(n.bind(null,"2cf6"))},children:[{path:"",name:"Cart",component:function(){return n.e("chunk-ec12f8ca").then(n.bind(null,"62b3"))}},{path:"payment/:orderId",name:"Payment",component:function(){return n.e("chunk-2d21dbd7").then(n.bind(null,"d31c"))}}]},{path:"/admin",component:function(){return Promise.all([n.e("chunk-76a56556"),n.e("chunk-bcdd3e26")]).then(n.bind(null,"0a6e"))},meta:{requiresAuth:!0},children:[{path:"products",name:"DashProducts",component:function(){return n.e("chunk-720241ba").then(n.bind(null,"fda8"))},meta:{requiresAuth:!0}},{path:"coupons",name:"Coupon",component:function(){return n.e("chunk-2d20fccc").then(n.bind(null,"b4bf"))},meta:{requiresAuth:!0}},{path:"orders",name:"DashOrders",component:function(){return n.e("chunk-7868cd31").then(n.bind(null,"9e4d"))},meta:{requiresAuth:!0}}]}],h=new f["a"]({routes:m,scrollBehavior:function(t,e,n){return n||{x:0,y:0}}}),l=h,p=(n("4160"),n("a434"),n("159b"),n("2f62")),g=n("dc59"),b=g["a"].firestore(),k={state:{products:[],orders:[]},mutations:{GETPRODUCTS:function(t,e){t.products=e},GETORDERS:function(t,e){t.orders=e}},actions:{getProducts:function(t){t.commit("LOADING",!0);var e=[];b.collection("products").get().then((function(n){n.forEach((function(t){e.push(Object.assign(t.data(),{productId:t.id}))})),t.commit("LOADING",!1),t.commit("GETPRODUCTS",e)})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e),alert("商品資料讀取失敗")}))},addProduct:function(t,e){t.commit("LOADING",!0),b.collection("products").add(e).then((function(){t.commit("LOADING",!1),t.dispatch("getProducts")})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e),alert("商品新增失敗")}))},updateProduct:function(t,e){var n=this;t.dispatch("updateLoading",!0);var c=e.productId;delete e.productId,b.collection("products").doc(c).update(e).then((function(){t.dispatch("updateLoading",!1),t.dispatch("getProducts")})).catch((function(t){n.$store.dispatch("updateLoading",!1),console.error("Error adding document: ",t),alert("商品更新失敗")}))},deleteProduct:function(t,e){t.commit("LOADING",!0),b.collection("products").doc(e).delete().then((function(){t.commit("LOADING",!1),t.dispatch("getProducts")})).catch((function(e){t.commit("LOADING",!1),console.error("Error removing document: ",e),alert("商品刪除失敗")}))},getOrders:function(t){t.commit("LOADING",!0);var e=[];b.collection("orders").get().then((function(n){n.forEach((function(t){e.push(Object.assign(t.data(),{orderId:t.id}))})),t.commit("LOADING",!1),t.commit("GETORDERS",e)})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e),alert("訂單資料讀取失敗")}))}},modules:{}},v=(n("4de4"),n("bc3a")),O=n.n(v),A=g["a"].firestore(),L={state:{cart:[],total:0},mutations:{GETCART:function(t,e){t.cart=e,this.commit("CALTOTAL",e)},CALTOTAL:function(t,e){var n=0;e.forEach((function(t){n+=t.qty*t.product.price})),t.total=n}},actions:{getCart:function(t){t.commit("LOADING",!0),O.a.get("https://us-central1-test-ecommerce-b68d1.cloudfunctions.net/app/api/cart-read").then((function(e){t.commit("GETCART",e.data),t.commit("LOADING",!1)})).catch((function(e){console.error("Error adding document: ",e),t.commit("LOADING",!1)}))},addtoCart:function(t,e){if(e.qty){var n=this.state.cart.cart,c=n.filter((function(t){return t.product.productId==e.id})),o={product:e.product,qty:e.qty};c.length>0&&(o.qty=e.qty+c[0].qty),t.commit("LOADING",!0),A.collection("cart").doc(e.id).set(o).then((function(){t.commit("LOADING",!1),t.dispatch("getCart"),t.dispatch("updateMessage",{message:"已加入購物車",status:"success"})})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e)}))}},deleteCart:function(t,e){t.commit("LOADING",!0),A.collection("cart").doc(e).delete().then((function(){t.commit("LOADING",!1),t.dispatch("getCart"),t.dispatch("updateMessage",{message:"已從購物車刪除商品",status:"success"})})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e),alert("刪除購物車失敗")}))},createOrder:function(t,e){t.commit("LOADING",!0),A.collection("order").add(e).then((function(e){t.commit("LOADING",!1)})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e)}))}},modules:{}},E=g["a"].firestore();c["default"].use(p["a"]);var D=new p["a"].Store({state:{isLoading:!1,active:"",cusProducts:[],messages:[]},mutations:{LOADING:function(t,e){t.isLoading=e},GETCUSPRODUCTS:function(t,e){t.cusProducts=e},MESSAGE:function(t,e){var n=e.message,c=e.status,o=Math.floor(new Date/1e3);t.messages.push({message:n,status:c,timestamp:o})},REMOVEMESSAGE:function(t,e){t.messages.splice(e,1)}},actions:{updateLoading:function(t,e){t.commit("LOADING",e)},getCusProducts:function(t){t.commit("LOADING",!0);var e=[];E.collection("products").where("using","==",!0).get().then((function(n){n.forEach((function(t){e.push(Object.assign(t.data(),{productId:t.id}))})),t.commit("LOADING",!1),t.commit("GETCUSPRODUCTS",e)})).catch((function(e){t.commit("LOADING",!1),console.error("Error adding document: ",e),alert("商品資料讀取失敗")}))},updateMessage:function(t,e){var n=e.message,c=e.status;t.commit("MESSAGE",{message:n,status:c});var o=Math.floor(new Date/1e3);t.dispatch("removeMessageWithTiming",o)},removeMessageWithTiming:function(t,e){setTimeout((function(){t.state.messages.forEach((function(n,c){n.timestamp==e&&t.state.messages.splice(c,1)}))}),5e3)},removeMessage:function(t,e){t.commit("REMOVEMESSAGE",e)}},modules:{admin:k,cart:L}}),I=(n("4989"),n("9062")),y=n.n(I),G=(n("e40d"),n("7bb1")),N=n("427f"),P=n.n(N),S=n("a925"),T=n("1157"),C=n.n(T);c["default"].use(S["a"]);var w,M=new S["a"]({locale:"zhTW"});c["default"].use(G["a"],{events:"input|blur",i18n:M,dictionary:{zhTW:P.a}}),c["default"].config.productionTip=!1,c["default"].component("Loading",y.a),g["a"].auth().onAuthStateChanged((function(t){w||(w=new c["default"]({i18n:M,router:l,store:D,render:function(t){return t(s)}}).$mount("#app"))})),l.beforeEach((function(t,e,n){var c=t.matched.some((function(t){return t.meta.requiresAuth})),o=g["a"].auth().currentUser;C()("#navbar-nav-toggle").prop("checked",!1),C()(".shoppingBtn").removeClass("active"),C()(".showCart").removeClass("active"),c&&!o?n("/signin"):n()}))},"5c0b":function(t,e,n){"use strict";var c=n("9c0c"),o=n.n(c);o.a},"9c0c":function(t,e,n){},dc59:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var c=n("8aa5"),o=n.n(c),r={apiKey:"AIzaSyDA7JptS9VedYYmDAqDueJvkXx5n4fIHwU",authDomain:"test-ecommerce-b68d1.firebaseapp.com",databaseURL:"https://test-ecommerce-b68d1.firebaseio.com",projectId:"test-ecommerce-b68d1",storageBucket:"test-ecommerce-b68d1.appspot.com",messagingSenderId:"737430624309",appId:"1:737430624309:web:54f855f3f46126fe11397c"},a=o.a.initializeApp(r)}});
//# sourceMappingURL=app.7652f2c0.js.map